import{S as Y,i as x,s as ee,D as oe,E as ce,a as w,d as h,b as p,f as S,H as f,Z as z,I as K,a1 as ve,e as $,t as A,k as B,c as I,g as N,n as j,h as F,r as ue,R as ge,T as be,w as fe,x as L,u as H,j as R,m as W,o as Z,_ as Q,v as G,$ as ke,a0 as ye,a3 as Ee,a6 as we}from"../../../chunks/vendor-b3a12ac3.js";import{g as te}from"../../../chunks/navigation-51f4a605.js";import{V as le}from"../../../chunks/Variety-ab1a983c.js";import{P as $e}from"../../../chunks/PollenIcon-b9e2ffc2.js";import{C as Ie}from"../../../chunks/CornIcon-26531608.js";import{H as Ve}from"../../../chunks/Header-5712565a.js";import{F as Pe}from"../../../chunks/Weather-186ca2b9.js";import"../../../chunks/singletons-12a22614.js";function De(n){let e,l,t,a;return{c(){e=oe("svg"),l=oe("path"),this.h()},l(s){e=ce(s,"svg",{xmlns:!0,viewBox:!0,stroke:!0,class:!0});var o=w(e);l=ce(o,"path",{d:!0}),w(l).forEach(h),o.forEach(h),this.h()},h(){p(l,"d","M16.32 14.9l5.39 5.4a1 1 0 0 1-1.42 1.4l-5.38-5.38a8 8 0 1 1 1.41-1.41zM10 16a6 6 0 1 0 0-12 6 6 0 0 0 0 12z"),p(e,"xmlns","http://www.w3.org/2000/svg"),p(e,"viewBox","0 0 24 24"),p(e,"stroke","currentColor"),p(e,"class",n[0])},m(s,o){S(s,e,o),f(e,l),t||(a=z(e,"click",n[1]),t=!0)},p(s,[o]){o&1&&p(e,"class",s[0])},i:K,o:K,d(s){s&&h(e),t=!1,a()}}}function Te(n,e,l){let{class:t=""}=e;function a(s){ve.call(this,n,s)}return n.$$set=s=>{"class"in s&&l(0,t=s.class)},[t,a]}class Ce extends Y{constructor(e){super();x(this,e,Te,De,ee,{class:0})}}const{Map:Se}=ye;function de(n,e,l){const t=n.slice();return t[6]=e[l][0],t[7]=e[l][1],t}function he(n,e,l){const t=n.slice();return t[10]=e[l],t}function Ae(n){let e,l;return{c(){e=$("span"),l=A("Unknown"),this.h()},l(t){e=I(t,"SPAN",{class:!0});var a=w(e);l=N(a,"Unknown"),a.forEach(h),this.h()},h(){p(e,"class","text-red-300")},m(t,a){S(t,e,a),f(e,l)},p:K,d(t){t&&h(e)}}}function Be(n){let e=n[10].gduToTassel+"",l;return{c(){l=A(e)},l(t){l=N(t,e)},m(t,a){S(t,l,a)},p(t,a){a&4&&e!==(e=t[10].gduToTassel+"")&&F(l,e)},d(t){t&&h(l)}}}function Ne(n){let e,l;return{c(){e=$("span"),l=A("Unknown"),this.h()},l(t){e=I(t,"SPAN",{class:!0});var a=w(e);l=N(a,"Unknown"),a.forEach(h),this.h()},h(){p(e,"class","text-red-300")},m(t,a){S(t,e,a),f(e,l)},p:K,d(t){t&&h(e)}}}function je(n){let e=n[10].gduToBlack+"",l;return{c(){l=A(e)},l(t){l=N(t,e)},m(t,a){S(t,l,a)},p(t,a){a&4&&e!==(e=t[10].gduToBlack+"")&&F(l,e)},d(t){t&&h(l)}}}function pe(n,e){let l,t,a=e[10].product+"",s,o,g,_,c,b,r,i,E,C,T;_=new $e({props:{class:"w-4 h-4 mr-2"}});function k(y,P){return y[10].gduToTassel?Be:Ae}let M=k(e),m=M(e);r=new Ie({props:{class:"w-4 h-4 ml-2 mr-2"}});function d(y,P){return y[10].gduToBlack?je:Ne}let V=d(e),u=V(e);function U(){return e[5](e[10])}return{key:n,first:null,c(){l=$("div"),t=$("div"),s=A(a),o=B(),g=$("div"),R(_.$$.fragment),c=B(),m.c(),b=B(),R(r.$$.fragment),i=B(),u.c(),this.h()},l(y){l=I(y,"DIV",{class:!0});var P=w(l);t=I(P,"DIV",{class:!0});var O=w(t);s=N(O,a),O.forEach(h),o=j(P),g=I(P,"DIV",{class:!0});var v=w(g);W(_.$$.fragment,v),c=j(v),m.l(v),b=j(v),W(r.$$.fragment,v),i=j(v),u.l(v),v.forEach(h),P.forEach(h),this.h()},h(){p(t,"class","flex-grow text-lg"),p(g,"class","flex flex-row mt-2"),p(l,"class","flex-col items-center cursor-pointer text-gray-700 hover:text-blue-400 hover:bg-blue-100 rounded-sm m-2 py-1"),this.first=l},m(y,P){S(y,l,P),f(l,t),f(t,s),f(l,o),f(l,g),Z(_,g,null),f(g,c),m.m(g,null),f(g,b),Z(r,g,null),f(g,i),u.m(g,null),E=!0,C||(T=z(l,"click",U),C=!0)},p(y,P){e=y,(!E||P&4)&&a!==(a=e[10].product+"")&&F(s,a),M===(M=k(e))&&m?m.p(e,P):(m.d(1),m=M(e),m&&(m.c(),m.m(g,b))),V===(V=d(e))&&u?u.p(e,P):(u.d(1),u=V(e),u&&(u.c(),u.m(g,null)))},i(y){E||(L(_.$$.fragment,y),L(r.$$.fragment,y),E=!0)},o(y){H(_.$$.fragment,y),H(r.$$.fragment,y),E=!1},d(y){y&&h(l),G(_),m.d(),G(r),u.d(),C=!1,T()}}}function _e(n){let e,l=n[6]+"",t,a,s,o=[],g=new Se,_,c=n[7];const b=r=>r[10].brand+r[10].product;for(let r=0;r<c.length;r+=1){let i=he(n,c,r),E=b(i);g.set(E,o[r]=pe(E,i))}return{c(){e=$("h2"),t=A(l),a=B(),s=$("div");for(let r=0;r<o.length;r+=1)o[r].c();this.h()},l(r){e=I(r,"H2",{class:!0});var i=w(e);t=N(i,l),i.forEach(h),a=j(r),s=I(r,"DIV",{class:!0});var E=w(s);for(let C=0;C<o.length;C+=1)o[C].l(E);E.forEach(h),this.h()},h(){p(e,"class","uppercase text-xs font-extralight tracking-wide pt-6"),p(s,"class","divide-y divide-gray-100")},m(r,i){S(r,e,i),f(e,t),S(r,a,i),S(r,s,i);for(let E=0;E<o.length;E+=1)o[E].m(s,null);_=!0},p(r,i){(!_||i&4)&&l!==(l=r[6]+"")&&F(t,l),i&5&&(c=r[7],ue(),o=ge(o,i,b,1,r,c,g,s,be,pe,null,he),fe())},i(r){if(!_){for(let i=0;i<c.length;i+=1)L(o[i]);_=!0}},o(r){for(let i=0;i<o.length;i+=1)H(o[i]);_=!1},d(r){r&&h(e),r&&h(a),r&&h(s);for(let i=0;i<o.length;i+=1)o[i].d()}}}function me(n){let e,l,t,a,s,o,g,_;return{c(){e=$("button"),l=$("p"),t=A("create "),a=$("span"),s=A(n[1]),o=A(" ..."),this.h()},l(c){e=I(c,"BUTTON",{class:!0});var b=w(e);l=I(b,"P",{class:!0});var r=w(l);t=N(r,"create "),a=I(r,"SPAN",{class:!0});var i=w(a);s=N(i,n[1]),o=N(i," ..."),i.forEach(h),r.forEach(h),b.forEach(h),this.h()},h(){p(a,"class","normal-case text-normal font-normal"),p(l,"class","font-light tracking-wide"),p(e,"class","mt-4")},m(c,b){S(c,e,b),f(e,l),f(l,t),f(l,a),f(a,s),f(a,o),g||(_=z(e,"click",n[3]),g=!0)},p(c,b){b&2&&F(s,c[1])},d(c){c&&h(e),g=!1,_()}}}function Ue(n){let e,l,t,a,s,o,g,_,c,b,r,i,E,C;o=new Ce({props:{class:"h-6 w-6"}});let T=Array.from(n[2].entries()),k=[];for(let d=0;d<T.length;d+=1)k[d]=_e(de(n,T,d));const M=d=>H(k[d],1,1,()=>{k[d]=null});let m=n[1].length>0&&me(n);return{c(){e=$("div"),l=$("div"),t=$("div"),a=$("label"),s=$("span"),R(o.$$.fragment),g=B(),_=$("input"),c=B(),b=$("div");for(let d=0;d<k.length;d+=1)k[d].c();r=B(),m&&m.c(),this.h()},l(d){e=I(d,"DIV",{});var V=w(e);l=I(V,"DIV",{});var u=w(l);t=I(u,"DIV",{class:!0});var U=w(t);a=I(U,"LABEL",{class:!0,for:!0});var y=w(a);s=I(y,"SPAN",{});var P=w(s);W(o.$$.fragment,P),P.forEach(h),g=j(y),_=I(y,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),y.forEach(h),U.forEach(h),c=j(u),b=I(u,"DIV",{class:!0});var O=w(b);for(let v=0;v<k.length;v+=1)k[v].l(O);r=j(O),m&&m.l(O),O.forEach(h),u.forEach(h),V.forEach(h),this.h()},h(){p(_,"id","search"),p(_,"type","text"),p(_,"placeholder","Search varieties"),p(_,"class","input input-bordered w-full"),p(a,"class","input-group"),p(a,"for","search"),p(t,"class","form-control"),p(b,"class","text-sm mt-3 px-2 h-60 overflow-y-scroll")},m(d,V){S(d,e,V),f(e,l),f(l,t),f(t,a),f(a,s),Z(o,s,null),f(a,g),f(a,_),Q(_,n[1]),f(l,c),f(l,b);for(let u=0;u<k.length;u+=1)k[u].m(b,null);f(b,r),m&&m.m(b,null),i=!0,E||(C=z(_,"input",n[4]),E=!0)},p(d,[V]){if(V&2&&_.value!==d[1]&&Q(_,d[1]),V&5){T=Array.from(d[2].entries());let u;for(u=0;u<T.length;u+=1){const U=de(d,T,u);k[u]?(k[u].p(U,V),L(k[u],1)):(k[u]=_e(U),k[u].c(),L(k[u],1),k[u].m(b,r))}for(ue(),u=T.length;u<k.length;u+=1)M(u);fe()}d[1].length>0?m?m.p(d,V):(m=me(d),m.c(),m.m(b,null)):m&&(m.d(1),m=null)},i(d){if(!i){L(o.$$.fragment,d);for(let V=0;V<T.length;V+=1)L(k[V]);i=!0}},o(d){H(o.$$.fragment,d),k=k.filter(Boolean);for(let V=0;V<k.length;V+=1)H(k[V]);i=!1},d(d){d&&h(e),G(o),ke(k,d),m&&m.d(),E=!1,C()}}}function Me(n,e,l){let{handleOnClick:t}=e,a="",s=new Map;function o(){te(`/varieties/new/edit?product=${encodeURIComponent(a)}`)}function g(){a=this.value,l(1,a)}const _=c=>{t(c)};return n.$$set=c=>{"handleOnClick"in c&&l(0,t=c.handleOnClick)},n.$$.update=()=>{n.$$.dirty&2&&le.searchByProduct(a).then(c=>{const b=c.reduce((r,i)=>r.set(i.brand,[...r.get(i.brand)||[],i]),new Map);l(2,s=b)})},[t,a,s,o,g,_]}class Oe extends Y{constructor(e){super();x(this,e,Me,Ue,ee,{handleOnClick:0})}}function Le(n){let e,l,t,a,s,o,g,_,c,b,r,i,E,C,T=n[1].product+"",k,M,m,d,V,u,U,y,P,O;return e=new Ve({props:{title:`Edit: ${n[0].name}`,backPath:"/fields/"+n[0].id}}),d=new Oe({props:{handleOnClick:n[3]}}),{c(){R(e.$$.fragment),l=B(),t=$("div"),a=$("div"),s=$("label"),o=$("span"),g=A("* Planted on"),_=B(),c=$("input"),b=B(),r=$("div"),i=$("label"),E=$("span"),C=A("* Variety: "),k=A(T),M=B(),m=$("div"),R(d.$$.fragment),V=B(),u=$("button"),U=A("Confirm Edit"),this.h()},l(v){W(e.$$.fragment,v),l=j(v),t=I(v,"DIV",{class:!0});var D=w(t);a=I(D,"DIV",{class:!0});var q=w(a);s=I(q,"LABEL",{class:!0,for:!0});var J=w(s);o=I(J,"SPAN",{class:!0});var ae=w(o);g=N(ae,"* Planted on"),ae.forEach(h),_=j(J),c=I(J,"INPUT",{id:!0,type:!0,"aria-required":!0,class:!0}),J.forEach(h),q.forEach(h),b=j(D),r=I(D,"DIV",{class:!0});var re=w(r);i=I(re,"LABEL",{class:!0,for:!0});var se=w(i);E=I(se,"SPAN",{class:!0});var X=w(E);C=N(X,"* Variety: "),k=N(X,T),X.forEach(h),se.forEach(h),re.forEach(h),M=j(D),m=I(D,"DIV",{class:!0});var ne=w(m);W(d.$$.fragment,ne),ne.forEach(h),V=j(D),u=I(D,"BUTTON",{class:!0,type:!0});var ie=w(u);U=N(ie,"Confirm Edit"),ie.forEach(h),D.forEach(h),this.h()},h(){p(o,"class","label-text"),p(c,"id","plantDate"),p(c,"type","date"),c.required=!0,p(c,"aria-required",""),p(c,"class","input"),p(s,"class","label"),p(s,"for","plantDate"),p(a,"class","form-control"),p(E,"class","label-text"),p(i,"class","label"),p(i,"for","variety"),p(r,"class","form-control"),p(m,"class",""),p(u,"class","btn btn-primary"),p(u,"type","submit"),p(t,"class","flex flex-col gap-2 px-2")},m(v,D){Z(e,v,D),S(v,l,D),S(v,t,D),f(t,a),f(a,s),f(s,o),f(o,g),f(s,_),f(s,c),Q(c,n[2]),f(t,b),f(t,r),f(r,i),f(i,E),f(E,C),f(E,k),f(t,M),f(t,m),Z(d,m,null),f(t,V),f(t,u),f(u,U),y=!0,P||(O=[z(c,"input",n[5]),z(u,"click",n[4])],P=!0)},p(v,[D]){const q={};D&1&&(q.title=`Edit: ${v[0].name}`),D&1&&(q.backPath="/fields/"+v[0].id),e.$set(q),D&4&&Q(c,v[2]),(!y||D&2)&&T!==(T=v[1].product+"")&&F(k,T)},i(v){y||(L(e.$$.fragment,v),L(d.$$.fragment,v),y=!0)},o(v){H(e.$$.fragment,v),H(d.$$.fragment,v),y=!1},d(v){G(e,v),v&&h(l),v&&h(t),G(d),P=!1,Ee(O)}}}const Ke=async({page:n})=>{const e=await Pe.get(n.params.id||"");if(!e)return te("/fields",{replaceState:!0});const l=await e.getVariety()||le.default();return{props:{varieties:await le.getAllProducts(),field:e,variety:l}}};function He(n,e,l){let{field:t}=e,{variety:a}=e,s=we(t.datePlanted||0,"yyyy-MM-dd");function o(c){l(1,a=c)}async function g(){return l(0,t.datePlanted=new Date(s),t),l(0,t.varietyId=a.id,t),await t.save(),te(`/fields/${t.id}`,{replaceState:!0})}function _(){s=this.value,l(2,s)}return n.$$set=c=>{"field"in c&&l(0,t=c.field),"variety"in c&&l(1,a=c.variety)},[t,a,s,o,g,_]}class Qe extends Y{constructor(e){super();x(this,e,He,Le,ee,{field:0,variety:1})}}export{Qe as default,Ke as load};
